- name: Test Nomad Deployment
  hosts: all
  become: no
  gather_facts: no

  tasks:
    - name: Import the Nomad playbook
      ansible.builtin.import_playbook: ../services/nomad.yaml

    - name: Check if the Nomad service is running
      ansible.builtin.systemd:
        name: nomad
      register: nomad_service_status
      failed_when: "nomad_service_status.status.ActiveState != 'active'"
      changed_when: false
