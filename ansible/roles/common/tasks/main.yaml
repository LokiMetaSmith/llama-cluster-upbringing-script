---
- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Upgrade all packages to the latest version
  apt:
    upgrade: dist

- name: Install common packages
  apt:
    name:
      - openssh-server
      - chrony
      - git
      - cmake
      - curl
      - python3-full
      - python3-pip
      - libcurl4-openssl-dev
    state: present

- name: Manage /etc/hosts file on controller for name resolution
  template:
    src: hosts.j2
    dest: /etc/hosts
  when: ansible_host == '127.0.0.1'
