---
- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Upgrade all packages to the latest version
  apt:
    upgrade: dist

- name: Install common packages
  apt:
    name:
      - openssh-server
      - chrony
      - git
      - cmake
      - curl
      - python3-full
      - python3-pip
      - libcurl4-openssl-dev
    state: present

- name: Disable unused wired ethernet interface to prevent routing issues
  community.general.nmcli:
    conn: enp3s0
    state: disconnected
  when: ansible_host != '127.0.0.1'
