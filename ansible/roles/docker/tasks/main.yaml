---
- name: Check if Docker is already installed
  stat:
    path: /usr/bin/docker
  register: docker_stat_result

- name: Download the official Docker installation script
  when: not docker_stat_result.stat.exists
  get_url:
    url: https://get.docker.com
    dest: /tmp/get-docker.sh
    mode: '0755'

- name: Run the Docker installation script
  when: not docker_stat_result.stat.exists
  command: /tmp/get-docker.sh

- name: Ensure Docker service is started and enabled
  systemd:
    name: docker
    state: started
    enabled: yes
