data_dir  = "{{ nomad_data_dir }}"
bind_addr = "{{ ansible_default_ipv4.address }}"

advertise {
  http = "{{ ansible_default_ipv4.address }}"
  rpc  = "{{ ansible_default_ipv4.address }}"
  serf = "{{ ansible_default_ipv4.address }}"
}

server {
  enabled          = true
  bootstrap_expect = 1
}

consul {
  address = "127.0.0.1:8500"
}

client {
  enabled = true
  options = {
    "driver.raw_exec.enable" = "1",
    "driver.exec.enable_chroot" = "false"
  }

  # The "snd" volume is required for voice applications but will prevent
  # Nomad from starting on machines without a sound device. It is commented
  # out to allow for more flexible deployment. The pipecat job itself will
  # still require this volume to be present on the target node.
  host_volume "snd" {
    path      = "/dev/snd"
    read_only = false
  }
}
